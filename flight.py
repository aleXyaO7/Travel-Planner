import requests

url = {
    'one_way': "https://priceline-com-provider.p.rapidapi.com/v2/flight/departures",
    'round_trip':"https://priceline-com-provider.p.rapidapi.com/v2/flight/roundTrip"
}

headers = {
	"X-RapidAPI-Key": "8e140a626fmsh377461c7298588ap138272jsnf7aef24a2a62",
	"X-RapidAPI-Host": "priceline-com-provider.p.rapidapi.com"
}

def query_one_way(departure_airport, destination_airport, departure_date, adults, children, cabin_class):
    querystring = {"sid":"iSiX639",
                "adults":adults,
                "children":children,
                "departure_date":departure_date,
                "destination_airport_code":destination_airport,
                "origin_airport_code":departure_airport,
                "cabin_class":cabin_class,
                "number_of_itineraries": 10,
                "currency":"USD"}
    response = requests.get(url['one_way'], headers=headers, params=querystring).json()
    flights = []
    for q in response['getAirFlightDepartures']['results']['result']['itinerary_data']:
        f = response['getAirFlightDepartures']['results']['result']['itinerary_data'][q]
        legs = []
        for r in f['slice_data']['slice_0']['flight_data']:
            i = f['slice_data']['slice_0']['flight_data'][r]
            legs.append({'departure_airport':i['departure']['airport']['code'],
                         'departure_date':i['departure']['datetime']['date'],
                         'departure_time':i['departure']['datetime']['time_12h'],
                         'arrival_airport':i['arrival']['airport']['code'],
                         'arrival_date':i['arrival']['datetime']['date'],
                         'arrival_time':i['arrival']['datetime']['time_12h']})
        flights.append({
            'airline':f['slice_data']['slice_0']['airline']['name'],
            'logo':f['slice_data']['slice_0']['airline']['logo'],
            'legs':legs,
            'price':f['price_details']['display_total_fare']
        })
    return flights

def query_round_trip(departure_airport, destination_airport, departure_date, return_date, adults, children, cabin_class):
    querystring = {"sid":"iSiX639",
                "adults":adults,
                "children":children,
                "departure_date":departure_date + ',' + return_date,
                "destination_airport_code":destination_airport + ',' + departure_airport,
                "origin_airport_code":departure_airport + ',' + destination_airport,
                "cabin_class":cabin_class,
                "number_of_itineraries": 10,
                "currency":"USD"}
    response = requests.get(url['round_trip'], headers=headers, params=querystring).json()
    flights = []
    for q in response['getAirFlightRoundTrip']['results']['result']['itinerary_data']:
        f = response['getAirFlightRoundTrip']['results']['result']['itinerary_data'][q]
        legs_departure, legs_return = [], []
        for r in f['slice_data']['slice_0']['flight_data']:
            i = f['slice_data']['slice_0']['flight_data'][r]
            legs_departure.append({'departure_airport':i['departure']['airport']['code'],
                         'departure_date':i['departure']['datetime']['date'],
                         'departure_time':i['departure']['datetime']['time_12h'],
                         'arrival_airport':i['arrival']['airport']['code'],
                         'arrival_date':i['arrival']['datetime']['date'],
                         'arrival_time':i['arrival']['datetime']['time_12h']})
        for r in f['slice_data']['slice_1']['flight_data']:
            i = f['slice_data']['slice_1']['flight_data'][r]
            legs_return.append({'departure_airport':i['departure']['airport']['code'],
                         'departure_date':i['departure']['datetime']['date'],
                         'departure_time':i['departure']['datetime']['time_12h'],
                         'arrival_airport':i['arrival']['airport']['code'],
                         'arrival_date':i['arrival']['datetime']['date'],
                         'arrival_time':i['arrival']['datetime']['time_12h']})
        flights.append({
            'airline':f['slice_data']['slice_0']['airline']['name'],
            'logo':f['slice_data']['slice_0']['airline']['logo'],
            'legs_departure':legs_departure,
            'legs_return':legs_return,
            'price':f['price_details']['display_total_fare']
        })
    return flights
    
def query_one_way2():
    return [{'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-11', 'departure_time': '3:35pm', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '5:20pm'}], 'price': 814.48}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-11', 'departure_time': '8:30pm', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '10:20pm'}], 'price': 814.48}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '8:05am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '9:50am'}], 'price': 814.48}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '9:20am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '11:10am'}], 'price': 814.48}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '10:35am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '12:15pm'}], 'price': 814.48}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '12:40pm', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '2:30pm'}], 'price': 814.48}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '8:01pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '6:50am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '9:00am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '11:25am'}], 'price': 883.4}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '7:30pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '6:40am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '9:00am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '11:25am'}], 'price': 883.4}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:30pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '8:30am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '11:30am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '1:50pm'}], 'price': 883.4}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '11:59pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '10:55am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '2:45pm', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '5:05pm'}], 'price': 883.4}]

def query_round_trip2():
    return [{'airline': 'Icelandair', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/FI.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '8:25pm', 'arrival_airport': 'KEF', 'arrival_date': '2024-03-11', 'arrival_time': '6:10am'}, {'departure_airport': 'KEF', 'departure_date': '2024-03-11', 'departure_time': '7:30am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '12:00pm'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '1:00pm', 'arrival_airport': 'KEF', 'arrival_date': '2024-03-12', 'arrival_time': '3:40pm'}, {'departure_airport': 'KEF', 'departure_date': '2024-03-12', 'departure_time': '4:50pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-12', 'arrival_time': '7:00pm'}], 'price': 1758.4}, {'airline': 'Icelandair', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/FI.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '8:25pm', 'arrival_airport': 'KEF', 'arrival_date': '2024-03-11', 'arrival_time': '6:10am'}, {'departure_airport': 'KEF', 'departure_date': '2024-03-11', 'departure_time': '7:45am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '12:10pm'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '1:00pm', 'arrival_airport': 'KEF', 'arrival_date': '2024-03-12', 'arrival_time': '3:40pm'}, {'departure_airport': 'KEF', 'departure_date': '2024-03-12', 'departure_time': '4:50pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-12', 'arrival_time': '7:00pm'}], 'price': 1758.4}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-11', 'departure_time': '8:30pm', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '10:20pm'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1784.44}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '8:05am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '9:50am'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1784.44}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '9:20am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '11:10am'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1784.44}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '10:35am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '12:15pm'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1784.44}, {'airline': 'Turkish Airlines', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/TK.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:00pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-11', 'arrival_time': '1:55pm'}, {'departure_airport': 'IST', 'departure_date': '2024-03-12', 'departure_time': '12:40pm', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-12', 'arrival_time': '2:30pm'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1784.44}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '8:01pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '6:50am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '9:00am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '11:25am'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1860.42}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '7:30pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '6:40am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '9:00am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '11:25am'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1860.42}, {'airline': 'Virgin Atlantic', 'logo': 'https://secure.rezserver.com/public/media/img/air_logos2/VS.png', 'legs_departure': [{'departure_airport': 'JFK', 'departure_date': '2024-03-10', 'departure_time': '9:30pm', 'arrival_airport': 'LHR', 'arrival_date': '2024-03-11', 'arrival_time': '8:30am'}, {'departure_airport': 'LHR', 'departure_date': '2024-03-11', 'departure_time': '11:30am', 'arrival_airport': 'CDG', 'arrival_date': '2024-03-11', 'arrival_time': '1:50pm'}], 'legs_return': [{'departure_airport': 'CDG', 'departure_date': '2024-03-12', 'departure_time': '6:50pm', 'arrival_airport': 'IST', 'arrival_date': '2024-03-13', 'arrival_time': '12:20am'}, {'departure_airport': 'IST', 'departure_date': '2024-03-13', 'departure_time': '3:10pm', 'arrival_airport': 'JFK', 'arrival_date': '2024-03-13', 'arrival_time': '7:10pm'}], 'price': 1860.42}]